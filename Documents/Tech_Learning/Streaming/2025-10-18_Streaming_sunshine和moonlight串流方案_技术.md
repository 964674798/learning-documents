# Sunshine 和 Moonlight 串流方案详解

## 目录
- [概述](#概述)
- [Sunshine 服务端](#sunshine-服务端)
- [Moonlight 客户端](#moonlight-客户端)
- [配置指南](#配置指南)
- [优化建议](#优化建议)
- [常见问题与解决方案](#常见问题与解决方案)
- [与其他串流方案对比](#与其他串流方案对比)

## 概述

Sunshine 和 Moonlight 是一对开源的游戏串流解决方案，允许玩家从服务器将游戏串流到多种设备上。Sunshine 是服务端软件，而 Moonlight 是客户端软件。这套方案基于 NVIDIA GameStream 协议，但相比原始 GameStream，它提供了跨平台支持和更多的自定义选项。

**主要特点：**
- 开源且免费
- 低延迟高质量视频串流
- 支持多平台（Windows、Linux、macOS、Android、iOS）
- 支持键盘、鼠标、游戏手柄输入
- 可自定义视频质量、分辨率和帧率
- 可用于游戏、远程桌面和媒体播放

## Sunshine 服务端

Sunshine 是运行在主机（通常是PC）上的串流服务器软件，负责捕获游戏或桌面画面，编码并通过网络发送。

### 系统要求

**最低配置：**
- 操作系统：Windows 8.1+, Linux, macOS 10.14+
- CPU：支持AVX2指令集的四核CPU
- GPU：支持硬件编码的显卡（NVIDIA GeForce GTX 600系列+, AMD RX系列, Intel HD 4000+）
- 网络：有线连接推荐，Wi-Fi需要5GHz频段

**推荐配置：**
- 操作系统：Windows 10/11, Ubuntu 20.04+, macOS 11+
- CPU：六核或更高
- GPU：NVIDIA GeForce GTX 10系列+, AMD RX 5000系列+
- 网络：有线千兆网络连接

### 安装步骤

1. 从[Sunshine GitHub仓库](https://github.com/LizardByte/Sunshine/releases)下载最新版本
2. 运行安装程序，按照指示完成安装
3. 首次启动时，Sunshine会生成一个网页管理界面，通常在 https://localhost:47990
4. 设置管理员密码
5. 在防火墙中允许Sunshine的网络访问

## Moonlight 客户端

Moonlight 是客户端应用，可安装在多种设备上，用于接收和显示Sunshine的串流内容。

### 支持的平台

- **Windows**：Windows 7及以上
- **macOS**：macOS 10.14及以上
- **Linux**：支持大多数主流发行版
- **Android**：Android 5.0及以上
- **iOS/iPadOS**：iOS 12.0及以上
- **树莓派**：通过专用镜像支持

### 安装步骤

1. 访问[Moonlight官方网站](https://moonlight-stream.org/)或应用商店
2. 下载对应您设备的版本
3. 安装并启动应用
4. 首次使用时，扫描局域网以查找运行Sunshine的服务器
5. 输入Sunshine提供的配对码完成配对

## 配置指南

### Sunshine 配置

#### 添加游戏/应用

1. 访问Sunshine的网页界面
2. 点击"Apps"选项卡
3. 点击"Add App"按钮
4. 填写以下信息：
   - 名称：显示在Moonlight中的名称
   - 可执行文件路径：游戏或应用的.exe文件路径
   - 工作目录：可执行文件所在目录（通常自动填充）
   - 启动命令行参数：如需要，添加额外的启动参数

#### 流媒体设置

在Sunshine网页界面的"Settings"选项卡中，可以配置以下关键参数：

| 参数 | 推荐设置 | 作用 |
|------|---------|------|
| 分辨率 | 1080p或您的显示器原生分辨率 | 设定串流视频的分辨率 |
| FPS | 60 | 串流的帧率，影响流畅度 |
| 比特率 | 有线网络：30-50Mbps<br>Wi-Fi：10-20Mbps | 视频质量和网络占用的权衡 |
| 编码 | HEVC(如设备支持)或H.264 | 视频编码格式，HEVC质量更高但要求更高 |
| HDR | 仅在支持HDR的显示器上启用 | 启用HDR内容串流 |

### Moonlight 配置

#### 流媒体设置

在Moonlight设置中，可以调整以下参数：

- **分辨率和帧率**：建议根据设备性能和网络条件选择
- **视频比特率**：越高质量越好，但需要更好的网络
- **视频解码**：可选择硬件或软件解码
- **音频配置**：支持环绕声配置
- **输入设置**：键盘、鼠标和控制器映射

#### 高级设置

- **网络优化**：设置缓冲区大小、抖动减少
- **输入模式**：直通模式或模拟模式
- **唤醒选项**：配置远程唤醒（WoL）

## 优化建议

### 网络优化

1. **有线连接**：尽可能使用有线网络连接
2. **网络QoS**：在路由器中为串流流量设置高优先级
3. **减少网络拥塞**：测试期间暂停其他大流量应用
4. **5GHz Wi-Fi**：如必须使用无线，选择5GHz网络而非2.4GHz

### 性能优化

1. **启用硬件加速**：确保服务端使用GPU硬件编码
2. **关闭垂直同步**：在游戏中关闭V-Sync以减少延迟
3. **调整电源设置**：设置为高性能模式
4. **后台应用**：关闭不必要的后台应用
5. **更新驱动**：保持显卡驱动为最新版本

## 常见问题与解决方案

### 配对问题

**问题**：无法在Moonlight中发现Sunshine服务器
**解决方案**：
- 确保两设备在同一网络中
- 临时禁用防火墙测试
- 检查Sunshine是否正常运行
- 手动输入服务器IP地址

### 性能相关

**问题**：画面卡顿或延迟高
**解决方案**：
- 降低视频分辨率和比特率
- 检查网络连接质量
- 关闭服务器上的其他占用资源的应用
- 确认是否开启了硬件加速编码

### 黑屏问题

**问题**：连接成功但显示黑屏
**解决方案**：
- 检查游戏启动路径是否正确
- 确认显卡驱动为最新版本
- 尝试不同的捕获方法（在Sunshine设置中）
- 重启Sunshine服务

## 与其他串流方案对比

| 功能/平台 | Sunshine+Moonlight | Steam Remote Play | NVIDIA GeForce NOW | Parsec |
|-----------|-------------------|-------------------|-------------------|--------|
| 开源 | ✅ | ❌ | ❌ | ❌ |
| 免费 | ✅ | ✅ | ❌ (有免费层) | ❌ (有免费层) |
| 跨平台支持 | 广泛 | 中等 | 中等 | 中等 |
| 自定义选项 | 很多 | 有限 | 非常有限 | 中等 |
| 延迟表现 | 极好 | 好 | 好 | 很好 |
| 本地网络性能 | 极好 | 很好 | 不适用 | 很好 |
| 互联网串流 | 需要额外配置 | 内置支持 | 原生支持 | 原生支持 |
| 技术要求 | 中等 | 低 | 低 | 低 |

---

Sunshine和Moonlight提供了强大而灵活的游戏串流解决方案，特别适合技术爱好者和希望获得最佳自定义体验的用户。虽然初始设置比商业解决方案稍复杂，但其性能、跨平台特性和开放性使其成为许多用户的首选。 